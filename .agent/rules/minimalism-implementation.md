# Minimalism Implementation Guide

このドキュメントは、Muブラウザのミニマリズム哲学を実装に落とし込むための具体的なガイドラインです。

## 哲学の原則

Muは「feature-rich and heavy」な現代ブラウザのアンチテーゼとして、以下を最優先します：

- **Minimalism Over Features**: 機能の豊富さより、シンプルさと焦点を重視
- **Content Focus**: コンテンツに集中できる環境、視覚的なノイズの排除
- **Performance**: ネイティブWebViewを活用した軽量設計
- **Keyboard-First**: キーボード中心の操作体系

## 1. UIデザインのミニマリズム

### 1.1 カラーパレット

**基本方針**: 3-4色の厳格な制限

```
構成:
- ベースカラー (背景色)
- テキストカラー (主要テキスト)
- グレートーン (ボーダー、無効状態、補助テキスト)
- アクセントカラー 1色のみ (リンク、主要ボタン、フォーカス状態)
```

**実装ルール**:

- アクセントカラーは機能的に重要な要素（リンク、アクティブタブ、フォーカス状態）にのみ使用
- 装飾目的での色使用は禁止
- セマンティックカラー（success/error/warning）は必要最小限に留め、アクセントカラーで代用可能か検討
- Tailwind CSSのカラーパレットは必要な色のみに絞り込む

### 1.2 アニメーション

**基本方針**: 必要最小限のトランジションのみ

**許可されるアニメーション**:

- フォーカス状態の遷移（200ms以下の短時間）
- タブ切り替え時のコンテンツフェード（必要な場合のみ）
- コマンドパレットの表示/非表示

**禁止事項**:

- 装飾的なアニメーション（bounce, wiggle, pulse等）
- ローディングスピナー（シンプルな進行状態表示のみ）
- ホバーエフェクトでの複雑なアニメーション

**実装**:

```css
/* 良い例 */
transition: opacity 200ms ease;

/* 悪い例 */
transition: all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55);
animation: bounce 1s infinite;
```

### 1.3 ビジュアルエフェクト

**禁止事項**:

- `box-shadow`（フォーカスリングを除く）
- グラデーション（`linear-gradient`, `radial-gradient`）
- ぼかし効果（`backdrop-filter: blur()`）
- 半透明オーバーレイ（必要最小限を除く）

**許可される例外**:

- キーボードフォーカスインジケーター（アクセシビリティ目的）
- ドロップダウン/モーダルの境界を明確にする1pxボーダー

### 1.4 アイコンとテキスト

**基本方針**: テキストラベルを優先、アイコンは補助的に使用

- アイコンのみのボタンは避け、必ずテキストラベルを併記（スペースが極端に限られる場合を除く）
- 装飾的なアイコン、イラストは使用しない
- アイコンは機能を直感的に示すシンプルなもののみ

## 2. 機能追加の判断基準

### 2.1 80/20ルール

新機能追加時は以下を自問：

- **この機能は80%のユーザーの20%の使用時間で使われるか？**
- **この機能なしでは、ブラウザとして成立しないか？**

どちらもNoの場合、機能追加は見送る。

### 2.2 機能追加チェックリスト

新機能を追加する前に、以下をすべて確認：

- [ ] この機能は既存機能の組み合わせで実現できないか？
- [ ] 設定項目を増やさずに実装できるか？
- [ ] UIに新しい要素を追加せずに実装できるか？
- [ ] キーボード操作のみで完結するか？
- [ ] この機能がなくても、ブラウジング体験は成立するか？（Yesなら追加しない）

### 2.3 設定項目の最小化

- カスタマイズ性よりシンプルさを優先
- 設定項目は「絶対に必要」な場合のみ追加
- デフォルト値は多数派ユーザーに最適化し、設定変更を前提としない

## 3. 依存ライブラリの管理

### 3.1 パッケージ追加の必須プロセス

新しいnpmパッケージを追加する前に：

1. **自前実装の検討（必須）**
   - 必要な機能が100行以内で実装できる場合は自前実装を選択
   - 複雑でも、パッケージの一部機能のみ使用する場合は自前実装を検討

2. **代替案の調査**
   - 既存の依存パッケージで代用できないか確認
   - ブラウザネイティブAPIで実現できないか確認

3. **パッケージの評価**
   - バンドルサイズへの影響を確認（`npm pack`または`bundlephobia.com`で確認）
   - Tree-shaking対応の確認
   - メンテナンス状況（最終更新、issue対応）

### 3.2 パッケージ追加の基準

以下のすべてを満たす場合のみ追加を検討：

- 自前実装が200行以上になる、または複雑なロジックが必要
- バンドルサイズへの影響が最小限（具体的な閾値は設定しない）
- 機能が複数箇所で使用される
- セキュリティリスクが低い（信頼できるメンテナー、定期的な更新）

### 3.3 Rust/Tauri側の依存管理

Cargo.tomlへのcrate追加も同様の原則：

- Tauriの標準プラグインを優先
- 小規模な機能は自前実装
- 大規模なcrate（例：画像処理、暗号化）は正当な理由がある場合のみ

## 4. キーボード操作とコマンドパレット

### 4.1 基本方針

**主要機能は必ずキーボードで操作可能にする**

- ページナビゲーション、タブ操作、検索は完全にキーボードで完結
- 設定やオプション機能は、マウス操作も許容

### 4.2 コマンドパレット設計

コマンドパレット（Ctrl+K / Cmd+K）は最も重要なUIインターフェース：

- すべての主要機能はコマンドパレット経由でアクセス可能
- コマンド名は明確で覚えやすいものにする
- よく使う機能は短いキーワードでも検索できるようにする
- コマンドの説明文は簡潔に（1行、50文字以内）

### 4.3 ショートカットキー

- グローバルショートカットは10個以内に制限
- 覚えやすいニーモニックを使用（例: Ctrl+T = New Tab）
- カスタマイズは提供しない（シンプルさ優先）

## 5. 通知とエラー表示

### 5.1 基本方針

**シンプルなトースト通知のみ使用**

- モーダルダイアログは重大なエラーや確認が必須の場合のみ
- トーストは画面の邪魔にならない位置（右下など）に短時間表示
- 装飾なし、アニメーションは最小限

### 5.2 実装ガイドライン

**トースト通知**:

```typescript
// 良い例：シンプルなテキストのみ
toast("Bookmark added")

// 悪い例：アイコン、進行バー、複数ボタン
toast({
  icon: "✓",
  title: "Success!",
  description: "Your bookmark has been added successfully",
  action: { label: "Undo", onClick: ... },
  progress: true
})
```

**エラー表示**:

- ユーザーに表示するエラーは最小限の情報のみ
- 技術的な詳細は開発者ツールのコンソールに記録
- エラーメッセージは明確で、次にすべきアクションを示す

## 6. パフォーマンス目標

### 6.1 起動時間

**目標**: アプリケーション起動からウィンドウ表示まで **1秒以内**

測定方法:

```bash
# Tauri起動時間の測定
time bun run tauri dev
```

改善策:

- 初期レンダリングの最小化
- 遅延ロード可能なコンポーネントの特定
- Rust側の初期化処理の最適化

### 6.2 バンドルサイズ

**目標**:

- フロントエンドバンドル（minified + gzipped）: **200KB以内**
- Tauriバイナリ: プラットフォームネイティブ並み（Windows: 10MB以内）

測定方法:

```bash
bun run build
# dist/ ディレクトリのサイズを確認
```

改善策:

- 不要な依存パッケージの削除
- Dynamic importの活用
- `vite-plugin-compression`でgzip圧縮の確認

### 6.3 メモリ使用量

**目標**: アイドル状態で **100MB以内**（Tauriプロセス + WebView）

測定方法:

- Windowsタスクマネージャー、またはActivityMonitor
- 開発者ツールのMemoryプロファイラー

改善策:

- 不要なDOMノードの削除
- イベントリスナーの適切なクリーンアップ
- 画像/リソースの遅延読み込み

### 6.4 継続的なモニタリング

パフォーマンスは定期的に測定：

- 主要機能追加時に上記3指標を測定
- 目標を超えた場合は、リファクタリングまたは機能削除を検討

## 7. 実装チェックリスト

新しいUI要素やコンポーネントを追加する際は、以下を確認：

### UIデザイン

- [ ] 使用している色は4色以内か？
- [ ] アニメーションは200ms以下で、機能的に必要か？
- [ ] box-shadow、グラデーション、ぼかしを使用していないか？
- [ ] アイコンのみのボタンになっていないか？

### 機能設計

- [ ] 80/20ルールに適合するか？
- [ ] 新しい設定項目を追加していないか？
- [ ] この機能は既存機能で代用できないか？

### コード実装

- [ ] 新しいパッケージ追加時に自前実装を検討したか？
- [ ] キーボードで操作可能か？
- [ ] エラー表示は最小限か？

### パフォーマンス

- [ ] バンドルサイズへの影響を確認したか？
- [ ] レンダリングパフォーマンスを測定したか？

---

## まとめ

このガイドラインは、Muの「軽量でミニマリスティック」な哲学を実装レベルで守るためのものです。迷った時は、**「これは本当に必要か？」「もっとシンプルにできないか？」** と自問してください。

**削除は追加より簡単**です。少ない機能から始めて、本当に必要なものだけを追加していく姿勢を保ちましょう。
